#include "enemy.h"
#include "map.h"


typedef struct {
	char name[32];
	MapData data;
} MapEntry;


MapEntry maps[5] = {
	{
		.name = "Level 1",
		.data = {
			.tiles = {
				{1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0},
				{1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0},
				{1,1,1,0,1,0,1,1,0,0,0,0,0,0,0,0},
				{1,0,1,1,1,0,1,1,0,0,0,0,0,0,0,0},
				{1,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0},
				{1,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0},
				{1,0,1,0,1,0,1,1,0,0,0,0,0,0,0,0},
				{1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0},
				{1,0,1,1,1,0,1,1,0,0,0,0,0,0,0,0},
				{1,0,1,0,1,0,0,1,0,0,0,0,0,0,0,0},
				{1,0,1,0,1,0,1,1,0,0,0,0,0,0,0,0},
				{1,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0},
				{1,0,1,0,1,1,0,1,0,0,0,0,0,0,0,0},
				{1,1,1,0,0,1,0,1,0,0,0,0,0,0,0,0},
				{1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0},
				{1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0}
			},
			.decorations = {
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,5,0,5,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0},
				{4,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
			},
			.doors = {
				{
					.doorPos = { 5, 4 },
					.movePos = { 5, 6 },
					.trigger = TRIGGER_ENABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 5, 5 },
					.movePos = { 5, 3 },
					.trigger = TRIGGER_DISABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 0, 4 },
					.movePos = { 14, 4 },
					.trigger = TRIGGER_NEXT_MAP,
				}
			},
			.encounterRate = { 5, 7 },
			.enemies = { &enemies[3], &enemies[4], &enemies[5] },
			.enemyRate = { 1, 3 },
			.respawn = { 3, 2 },
		}
	},
	{
		.name = "Level 2",
		.data = {
			.tiles = {
				{0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1},
				{0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1},
				{0,0,0,0,0,0,0,1,0,1,0,1,0,1,0,1},
				{0,0,0,0,0,0,0,1,1,1,1,1,0,1,1,1},
				{0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1},
				{0,0,0,0,0,0,0,1,1,0,1,1,0,1,0,1},
				{0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,1},
				{0,0,0,0,0,0,0,1,1,1,0,1,0,1,1,1},
				{0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,1},
				{0,0,0,0,0,0,0,1,0,1,1,1,0,1,0,1},
				{0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1},
				{0,0,0,0,0,0,0,1,0,1,1,1,0,1,0,1},
				{0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1},
				{0,0,0,0,0,0,0,1,1,1,0,1,0,1,0,1},
				{0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1},
				{0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1}
			},
			.decorations = {
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,5,5,5,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,5,3,5,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0}
			},
			.doors = {
				{
					.doorPos = { 15, 4 },
					.movePos = { 1, 4 },
					.trigger = TRIGGER_PREV_MAP,
				},
				{
					.doorPos = { 9, 3 },
					.movePos = { 9, 1},
					.trigger = TRIGGER_DISABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 9, 2 },
					.movePos = { 9, 4 },
					.trigger = TRIGGER_ENABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 8, 15 },
					.movePos = { 7, 1 },
					.trigger = TRIGGER_NEXT_MAP
				}
			},
			.encounterRate = { 5, 7 },
			.enemies = { &enemies[6], &enemies[7], &enemies[8] },
			.enemyRate = { 4, 6 },
			.respawn = { 8, 1 },
		}
	},
	{
		.name = "Level 3",
		.data = {
			.tiles = {
				{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
				{1,0,0,1,0,0,1,0,0,0,1,0,1,0,0,1},
				{1,0,0,1,0,1,1,1,1,0,1,0,1,0,0,1},
				{1,1,1,1,0,0,0,0,0,0,1,0,1,1,1,1},
				{1,0,1,0,0,1,0,1,1,1,1,0,0,1,0,1},
				{1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1},
				{1,0,1,1,1,1,0,1,1,1,1,1,0,1,0,1},
				{1,1,1,0,0,0,0,1,0,0,0,1,0,1,1,1},
				{1,0,0,0,0,1,0,1,0,1,0,1,0,0,0,1},
				{1,0,1,1,0,1,0,1,0,1,1,1,1,1,0,1},
				{1,0,0,1,0,1,0,1,0,0,0,0,0,0,0,1},
				{1,0,1,1,0,1,1,1,0,1,1,0,0,1,0,1},
				{1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1},
				{1,0,0,1,0,1,1,1,0,1,1,0,1,0,0,1},
				{1,0,0,1,0,0,0,0,0,0,0,0,1,0,0,1},
				{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1}
			},
			.decorations = {
				{0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0},
				{0,5,5,0,0,0,0,0,0,0,0,0,0,5,5,0},
				{0,5,5,0,0,0,0,0,0,0,0,0,0,5,5,0},
				{0,0,3,0,0,0,0,0,0,0,0,0,0,3,0,0},
				{0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,3,0,0,0,0,0,0,0,0,0,0,3,0,0},
				{0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0},
				{0,5,5,0,0,0,0,0,0,0,0,0,0,5,5,0},
				{0,5,5,0,0,0,0,0,0,0,0,0,0,5,5,0},
				{0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0}
			},
			.doors = {
				{
					.doorPos = { 7, 0 },
					.movePos = { 8, 14 },
					.trigger = TRIGGER_PREV_MAP,
				},
				{
					.doorPos = { 8, 15 },
					.movePos = { 8, 14 },
					.trigger = TRIGGER_NEXT_MAP,
				},
				{
					.doorPos = { 13, 11 },
					.movePos = { 13, 13 },
					.trigger = TRIGGER_DISABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 13, 12 },
					.movePos = { 13, 10 },
					.trigger = TRIGGER_ENABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 13, 4 },
					.movePos = { 13, 2 },
					.trigger = TRIGGER_DISABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 13, 3 },
					.movePos = { 13, 5 },
					.trigger = TRIGGER_ENABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 2, 4 },
					.movePos = { 2, 2 },
					.trigger = TRIGGER_DISABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 2, 3 },
					.movePos = { 2, 5 },
					.trigger = TRIGGER_ENABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 2, 11 },
					.movePos = { 2, 13 },
					.trigger = TRIGGER_DISABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 2, 12 },
					.movePos = { 2, 10 },
					.trigger = TRIGGER_ENABLE_ENCOUNTERS,
				},
			},
			.encounterRate = { 5, 7 },
			.enemies = { &enemies[9], &enemies[10], &enemies[11] },
			.enemyRate = { 4, 6 },
			.respawn = { 1, 1 },
		}
	},
	{
		.name = "Level 4",
		.data = {
			.tiles = {
				{0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0},
				{0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1},
				{0,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1},
				{0,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1},
				{0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0},
				{0,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0},
				{0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0},
				{0,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0},
				{0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0},
				{0,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0},
				{0,0,0,0,1,0,0,1,0,1,0,0,1,0,0,0},
				{0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0}
			},
			.decorations = {
				{0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,5,5,5,2,4,0,0,0,2,4,5,5,5,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0}
			},
			.doors = {
				{
					.doorPos = { 8, 15 },
					.movePos = { 8, 14 },
					.trigger = TRIGGER_PREV_MAP,
				},
				{
					.doorPos = { 8, 0},
					.movePos = { 8, 1},
					.trigger = TRIGGER_NEXT_MAP,
				},
				{
					.doorPos = { 6, 6 },
					.movePos = { 4, 6 },
					.trigger = TRIGGER_DISABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 5, 6 },
					.movePos = { 7, 6 },
					.trigger = TRIGGER_ENABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 10, 6 },
					.movePos = { 12, 6 },
					.trigger = TRIGGER_DISABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 11, 6 },
					.movePos = { 9, 6 },
					.trigger = TRIGGER_ENABLE_ENCOUNTERS,
				},
			},
			.encounterRate = { 5, 7 },
			.enemies = { &enemies[12], &enemies[13], &enemies[14] },
			.enemyRate = { 6, 6 },
			.respawn = { 4, 6 },
		}
	},
	{
		.name = "The Gauntlet",
		.data = {
			.tiles = {
				{0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0},
				{0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0},
				{0,0,0,0,1,0,1,1,1,1,0,0,0,0,0,0},
				{0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0},
				{0,0,0,0,1,1,1,1,0,1,1,1,1,0,0,0},
				{0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0},
				{0,0,0,0,1,1,1,1,1,1,1,0,1,0,0,0},
				{0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0},
				{0,0,0,0,1,0,1,1,1,1,1,1,1,0,0,0},
				{0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0},
				{0,0,0,0,1,1,1,1,1,1,1,0,1,0,0,0},
				{0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0},
				{0,0,1,1,1,1,0,1,1,1,1,1,1,0,0,0},
				{0,0,1,0,0,1,0,0,0,1,0,0,0,0,0,0},
				{0,0,1,0,0,1,1,0,0,1,0,0,0,0,0,0},
				{0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0}
			},
			.decorations = {
				{0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,5,5,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,5,5,2,4,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0}
			},
			.doors = {
				{
					.doorPos = { 6, 14 },
					.movePos = { 4, 14 },
					.trigger = TRIGGER_DISABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 5, 14 },
					.movePos = { 7, 14 },
					.trigger = TRIGGER_ENABLE_ENCOUNTERS,
				},
				{
					.doorPos = { 8, 0},
					.movePos = { 8, 14},
					.trigger = TRIGGER_NEXT_MAP,
				},
				{
					.doorPos = { 8, 15 },
					.trigger = TRIGGER_BOSS,
				}
			},
			.encounterRate = { 5, 7 },
			.enemies = { &enemies[15], &enemies[16], &enemies[17] },
			.enemyRate = { 1, 3 },
			.respawn = { 3, 14 },
		}
	},
};


Door *FindDoorAtPosition(MapData *mapData, struct xy pos)
{
	for (int i = 0; i < 10; i++) {
		if (mapData->doors[i].doorPos.x == pos.x && mapData->doors[i].doorPos.y == pos.y) {
			return &mapData->doors[i];
		}
	}
	return NULL;
}


MapData *LoadMap(int index) 
{
	return &maps[index].data;
}

char *LoadMapName(int index)
{
	return &maps[index].name;
}